# Voix Configuration File
# This file defines access control rules for the Voix privilege escalation tool
#
# Syntax: permit|deny [persist|nopasswd|keepenv] <user|group:name> [as <target>] [cmd <command>]
#
# Examples:
#   permit veridian as root                    - Allow user veridian to run any command as root
#   permit persist veridian as root            - Allow with auth caching (15 minutes)
#   permit nopasswd veridian as root           - Allow without password authentication
#   permit keepenv veridian as root            - Preserve environment variables
#   permit group:wheel as root                 - Allow all users in wheel group
#   permit veridian cmd /usr/bin/systemctl     - Allow only systemctl command
#   deny veridian cmd /bin/rm -rf /            - Explicitly deny dangerous commands

# Basic user permissions
permit persist <USER> as root

# Group-based permissions
permit group:wheel as root
permit group:developers as root cmd /usr/bin/make

# GUI applications with environment preservation
permit keepenv <USER> cmd /usr/bin/firefox
permit keepenv <USER> cmd /usr/bin/chromium
permit keepenv <USER> cmd /usr/bin/code

# System management tools
permit <USER> cmd /usr/bin/systemctl
permit <USER> cmd /usr/bin/journalctl
permit <USER> cmd /usr/bin/dmesg

# Package management
permit <USER> cmd /usr/bin/pacman
permit <USER> cmd /usr/bin/apt
permit <USER> cmd /usr/bin/yum
permit <USER> cmd /usr/bin/dnf

# Network tools
permit <USER> cmd /usr/bin/ping
permit <USER> cmd /usr/bin/traceroute
permit <USER> cmd /usr/bin/nmap

# Development tools
permit <USER> cmd /usr/bin/gcc
permit <USER> cmd /usr/bin/g++
permit <USER> cmd /usr/bin/cmake
permit <USER> cmd /usr/bin/make

# Explicitly dangerous commands (examples - adjust for your system)
deny <USER> cmd /bin/rm -rf /
deny <USER> cmd /usr/bin/dd
deny <USER> cmd /usr/bin/mkfs
deny <USER> cmd /usr/bin/fdisk

# Service management (restrictive)
permit <USER> cmd /usr/bin/systemctl start *
permit <USER> cmd /usr/bin/systemctl stop *
permit <USER> cmd /usr/bin/systemctl restart *
permit <USER> cmd /usr/bin/systemctl status *

# User management (if needed)
permit <USER> cmd /usr/bin/useradd
permit <USER> cmd /usr/bin/usermod
permit <USER> cmd /usr/bin/userdel
